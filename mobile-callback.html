<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Signing in...</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
</head>
<body>
    <h3>Completing sign-in...</h3>

    <script>
        (function () {
            try {
                // Extract full query and hash
                const query = window.location.search || "";
                const hash = window.location.hash || "";

                console.log("OAuth callback received:", query, hash);

                // IMPORTANT: small delay to ensure cookies are stored
                const DELAY_MS = 10000;

                setTimeout(() => {
                    // Your mobile deep link
                    const deepLink = "mobilereflect://callback" + query + hash;

                    console.log("Redirecting to mobile app:", deepLink);

                    // Redirect to mobile app
                    window.location.href = deepLink;
                }, DELAY_MS);

                // Optional fallback: if mobile app not installed
                setTimeout(() => {
                    console.log("Fallback triggered");

                    // Redirect user to install page or help page
                    window.location.href = "https://yourdomain.com/install-app";
                }, 20000);

            } catch (err) {
                console.error("Callback error:", err);
            }
        })();
    </script>
</body>
</html>
